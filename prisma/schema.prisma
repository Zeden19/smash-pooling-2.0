generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Session {
  id        String   @id
  userId    String
  expiresAt DateTime

  user User @relation(references: [id], fields: [userId], onDelete: Cascade)
}

model User {
  id             String @id
  startggId      Int    @unique
  gamertag       String
  slug           String
  email          String
  profilePicture String @db.VarChar(1000)

  sessions          Session[]
  carpoolsDriving   Carpool[] @relation(name: "CarpoolDriver") // many to one
  carpoolsAttending Carpool[] @relation(name: "CarpoolAttendee") // many to many

  isDriver    Boolean?
  fullName    String?
  carInfo     String?
  carSeats    String?
  phoneNumber String?
}

model Carpool {
  id        Int    @id @default(autoincrement())
  driver    User   @relation(fields: [driverId], references: [id], name: "CarpoolDriver")
  driverId  String
  attendees User[] @relation(name: "CarpoolAttendee")

  originLat       Decimal
  originLng       Decimal
  originName      String
  destinationLat  Decimal
  destinationLng  Decimal
  destinationName String

  tournamentSlug String
  distance       String
  route          Json
  seatsAvailable Int?
  startTime      DateTime?
  status         CarpoolStatus @default(OPEN)
  price          Int           @default(0)
  description    String        @default("")
}

enum CarpoolStatus {
  OPEN
  IN_PROGRESS
  COMPLETED
}
